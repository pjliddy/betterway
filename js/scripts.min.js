"use strict";function renderTemplate(t,e){var a=Handlebars.compile(t),n=a({data:e});return n}function replaceTemplate(t,e,a){var n=Handlebars.compile(e),o=n({data:a});$(t).html(o)}function appendTemplate(t,e,a){var n=Handlebars.compile(e),o=n({data:a});$(t).append(o)}function removeTemplate(t){$(t).remove()}function showModal(t){$(".modal").length?replaceTemplate($(".modal")[0],t):$("body").append(t),$(".modal").modal("show")}function getListingData(t){return $.ajax({url:t,cache:!0})}function getTemplate(t){return $.ajax({url:t,cache:!0})}function submitContact(t){return $.ajax({url:"./cgi/submit.php",type:"POST",data:t,cache:!1})}function getDetailData(t){for(var e=0;e<listingsObj.data.length;e++)if(listingsObj.data[e].mls==t)return listingsObj.data[e]}function showDetails(t){getTemplate("js/templates/modal-detail.hbs").then(function(e){var a=getDetailData(t),n=renderTemplate(e,a);showModal(n)}).fail(function(t){return console.log("listing template is not available")})}function setUpGallery(){$("#carousel").flexslider({animation:"slide",controlNav:!1,animationLoop:!1,slideshow:!1,itemWidth:210,itemMargin:5,asNavFor:"#slider"}),$("#slider").flexslider({animation:"slide",controlNav:!1,animationLoop:!1,slideshow:!1,sync:"#carousel"})}function showContactForm(){getTemplate("js/templates/modal-contact.hbs").then(function(t){var e=renderTemplate(t);showModal(e),$("#phone").mask("(999) 999-9999",{placeholder:" "})}).fail(function(t){return console.log("contact template is not available")})}function showSubmitError(){getTemplate("js/templates/modal-submit-error.hbs").then(function(t){var e=renderTemplate(t);showModal(e)}).fail(function(t){return console.log("submit errror template is not available")})}function showSubmitSuccess(){getTemplate("js/templates/modal-submit-success.hbs").then(function(t){var e=renderTemplate(t);showModal(e)}).fail(function(t){return console.log("submit success template is not available")})}function handleEvents(){$("a.page-scroll").bind("click",function(t){var e=$(this);$("html, body").stop().animate({scrollTop:$(e.attr("href")).offset().top-92},800,"easeInOutExpo"),t.preventDefault()}),$("body").scrollspy({target:".navbar-fixed-top",offset:92}),$(".navbar-collapse ul li a").click(function(){$(".navbar-toggle:visible").click()}),$("#mainNav").affix({offset:{top:92}}),$(".listings").on("click",".see-more",function(t){showDetails($(t.target).data("mls"))}),$(".contact-btn").click(function(t){showContactForm()}),$("body").on("submit","form#contact-form",function(t){console.log("submit form"),t.preventDefault();var e=$("input#firstName").val()+" "+$("input#lastName").val(),a=$("input#email").val(),n=$("input#phone").val(),o={name:e,email:a,phone:n};submitContact(o).then(showSubmitSuccess).fail(showSubmitError),$("form#contact-form input").val("")}),$("body").on("shown.bs.modal","#detail-modal",function(){setUpGallery()}),$("body").on("hidden.bs.modal",".modal",function(){removeTemplate(".modal")})}var listingsObj={};$(function(){handleEvents(),listingsObj=new ListingData,getListingData(listingsObj.url).then(function(t){listingsObj.setData(t.feed.entry),getTemplate("js/templates/listings.hbs").then(function(t){replaceTemplate("#listings",t,listingsObj.data)}).fail(function(t){return console.log("listing template is not available")})}).fail(function(t){return console.log("data feed is not available")})});